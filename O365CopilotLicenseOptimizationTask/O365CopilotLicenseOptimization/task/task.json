{
    "id": "cb66070c-2c52-4289-ac60-ce7fe68506e5",
    "name": "O365CopilotLicenseOptimization",
    "friendlyName": "O365 Copilot License Optimization",
    "description": "O365 Copilot License Optimization - Fetch all users license type across O365 Platform.",
    "helpUrl": "https://www.microsoft.com/en-us/microsoft-365-copilot/pricing",
    "helpMarkDown": "[Learn more about this task](https://www.microsoft.com/en-us/microsoft-365-copilot/pricing)",
    "category": "Utility",
    "visibility": [
        "Build",
        "Release"
    ],
    "runsOn": [
        "Agent",
        "DeploymentGroup"
    ],
    "author": "Aammir Mirza",
    "version": {
        "Major": 1,
        "Minor": 0,
        "Patch": 0
    },
    "releaseNotes": "Script task consistency. Added support for macOS and Linux.",
    "minimumAgentVersion": "2.115.0",
    "showEnvironmentVariables": true,
    "inputs": [
        {
            "name": "azureServiceConnection",
            "type": "connectedService:azureRM",
            "label": "Azure Service Connection",
            "required": true,
            "helpMarkDown": "Azure RM service connection (Service Principal) used to request a Microsoft Graph token for Reports.Read.All."
        },
        {
            "name": "inactiveDaysThreshold",
            "type": "string",
            "label": "Inactive Days Threshold",
            "required": true,
            "defaultValue": "30",
            "helpMarkDown": "Users with no Copilot activity for this many days will be flagged."
        },
        {
            "name": "Revoke",
            "type": "string",
            "label": "Revoke Flag",
            "required": false,
            "helpMarkDown": "Set to 'Yes' (or any non-empty value) to mark candidates for license revocation."
        }
    ],
    "instanceNameFormat": "O365 Copilot License Optimization",
    "execution": {
        "Node": {
          "target": "$(currentDirectory)/O365CopilotLicenseOptimization.js",
          "argumentFormat": "",
          "workingDirectory": "$(currentDirectory)"
        }
      },
      "messages": {
          "GeneratingScript": "Generating script.",
          "JS_InvalidErrorActionPreference": "Invalid ErrorActionPreference '%s'. The value must be one of: 'Stop', or 'SilentlyContinue'"
      }
}
